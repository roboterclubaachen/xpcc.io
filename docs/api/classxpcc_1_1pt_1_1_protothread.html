<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>xpcc: xpcc::pt::Protothread Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">xpcc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="modules.html"><span>API</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="../index.html"><span>General</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classxpcc_1_1pt_1_1_protothread.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="classxpcc_1_1pt_1_1_protothread-members.html">List of all members</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">xpcc::pt::Protothread Class Reference<div class="ingroups"><a class="el" href="group__processing.html">Processing</a> &raquo; <a class="el" href="group__protothread.html">Protothreads</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A very lightweight, stackless thread.  
 <a href="classxpcc_1_1pt_1_1_protothread.html#details">More...</a></p>

<p><code>#include &lt;xpcc/processing/protothread/protothread.hpp&gt;</code></p>
<div class="dynheader">
Inheritance diagram for xpcc::pt::Protothread:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classxpcc_1_1pt_1_1_protothread.png" usemap="#xpcc::pt::Protothread_map" alt=""/>
  <map id="xpcc::pt::Protothread_map" name="xpcc::pt::Protothread_map">
<area href="classxpcc_1_1_ds1631.html" title="DS1631, DS1631A and DS1731 temperature sensor driver. " alt="xpcc::Ds1631&lt; I2cMaster &gt;" shape="rect" coords="0,56,169,80"/>
<area href="classxpcc_1_1_tmp102.html" title="TMP102 digital temperature sensor driver. " alt="xpcc::Tmp102&lt; I2cMaster &gt;" shape="rect" coords="179,56,348,80"/>
<area href="classxpcc_1_1_tmp175.html" title="TMP175 digital temperature sensor driver. " alt="xpcc::Tmp175&lt; I2cMaster &gt;" shape="rect" coords="358,56,527,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a60c9acd2c0f6fe5cfe8f04c4c08b78f4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a60c9acd2c0f6fe5cfe8f04c4c08b78f4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a60c9acd2c0f6fe5cfe8f04c4c08b78f4">Protothread</a> ()</td></tr>
<tr class="memdesc:a60c9acd2c0f6fe5cfe8f04c4c08b78f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new protothread that will start from the beginning of its run() function. <br /></td></tr>
<tr class="separator:a60c9acd2c0f6fe5cfe8f04c4c08b78f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c9892ebfbed1112dd5a7dc8882c0e94"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c9892ebfbed1112dd5a7dc8882c0e94"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a3c9892ebfbed1112dd5a7dc8882c0e94">restart</a> ()</td></tr>
<tr class="memdesc:a3c9892ebfbed1112dd5a7dc8882c0e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart protothread. <br /></td></tr>
<tr class="separator:a3c9892ebfbed1112dd5a7dc8882c0e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c7c84a815782e69d7d0c33d76c4b9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a61c7c84a815782e69d7d0c33d76c4b9e">stop</a> ()</td></tr>
<tr class="memdesc:a61c7c84a815782e69d7d0c33d76c4b9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the protothread from running.  <a href="#a61c7c84a815782e69d7d0c33d76c4b9e">More...</a><br /></td></tr>
<tr class="separator:a61c7c84a815782e69d7d0c33d76c4b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74d6c935ce548a93698d902420cbaab9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a74d6c935ce548a93698d902420cbaab9">isRunning</a> () const </td></tr>
<tr class="memdesc:a74d6c935ce548a93698d902420cbaab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the protothread is still running.  <a href="#a74d6c935ce548a93698d902420cbaab9">More...</a><br /></td></tr>
<tr class="separator:a74d6c935ce548a93698d902420cbaab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Because protothreads do not save the stack context across a blocking call, local variables are not preserved when the protothread blocks. This means that local variables should be used with utmost care - if in doubt, do not use local variables inside a protothread! Use private/protected member variables to save state between a context switch.</p>
<p>A protothread is driven by repeated calls to the run()-function in which the protothread is running. Each time the function is called, the protothread will run until it blocks or exits. Thus the scheduling of protothreads is done by the application that uses protothreads.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;xpcc/architecture.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;xpcc/utils/protothread.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;xpcc/utils/timeout.hpp&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> GpioOutputB0 Led;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>BlinkingLight : <span class="keyword">public</span> <a class="code" href="classxpcc_1_1pt_1_1_protothread.html">xpcc::pt::Protothread</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span></div>
<div class="line">    run()</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="group__protothread.html#ga6da3471eb116970eb1dce79bfcc7cd3e">PT_BEGIN</a>();</div>
<div class="line"></div>
<div class="line">        <span class="comment">// set everything up</span></div>
<div class="line">        Led::setOutput();</div>
<div class="line">        Led::set();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line">        {</div>
<div class="line">            timeout.restart(100);</div>
<div class="line">            Led::set();</div>
<div class="line">            <a class="code" href="group__protothread.html#ga742a4c6aa99440473f54651233ebd28b">PT_WAIT_UNTIL</a>(timeout.isExpired());</div>
<div class="line"></div>
<div class="line">            timeout.restart(200);</div>
<div class="line">            Led::reset();</div>
<div class="line">            <a class="code" href="group__protothread.html#ga742a4c6aa99440473f54651233ebd28b">PT_WAIT_UNTIL</a>(timeout.isExpired());</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="group__protothread.html#ga146c4bb0e1f9f2020cd12b8dd7ff076e">PT_END</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code" href="classxpcc_1_1_generic_timeout.html">xpcc::ShortTimeout</a> timeout;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">...</div>
<div class="line">BlinkingLight light;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">while</span> (...) {</div>
<div class="line">    light.run();</div>
<div class="line">}</div>
</div><!-- fragment --><p>For other examples take a look in the <code>examples</code> folder in the XPCC root folder.</p>
<dl class="section warning"><dt>Warning</dt><dd>The names <code>ptState</code> and <code>ptYield</code> are reserved and may not be used as variables or function names! </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a61c7c84a815782e69d7d0c33d76c4b9e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void xpcc::pt::Protothread::stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Happens automatically at PT_END.</p>
<dl class="section note"><dt>Note</dt><dd>This differs from the Dunkels' original protothread behavior (his restart automatically, which is usually not what you want). </dd></dl>

</div>
</div>
<a class="anchor" id="a74d6c935ce548a93698d902420cbaab9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool xpcc::pt::Protothread::isRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the protothread is running or waiting, <code>false</code> if it has ended or exited. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>protothread/protothread.hpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacexpcc.html">xpcc</a></li><li class="navelem"><b>pt</b></li><li class="navelem"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html">Protothread</a></li>
    <li class="footer">Generated on Thu Apr 6 2017 23:40:48 for xpcc by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
